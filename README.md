# HIDS
The goal of this project was to develop a Host-based Intrusion Detection System (HIDS) using PowerShell. 

This system is designed to monitor the integrity of specific files and send email alerts to an administrator as soon as a change is detected. To achieve this, I separated the architecture into several components for greater clarity and security. The core engine is the HIDS-Monitor.ps1 script, which contains all the monitoring logic. Parameters, such as the paths of the files to monitor and the SMTP server information, are stored in an external JSON configuration file named HIDS-Config.json. SMTP credentials are managed securely using an SMTP_Credential.xml file, which stores the password in encrypted form. Integrity verification relies on a baseline named HIDS-Baseline.dat. This baseline is created the first time the HIDS-Monitor.ps1 script is run. The script calculates the SHA256 cryptographic hash of each target file using the Get-IntegrityHash function and stores these hashes in the HIDS-Baseline.dat file.

Once this baseline is established, the script enters a continuous monitoring loop (while ($true)). At regular intervals, it recalculates the hash of each file and compares it to the one stored in the baseline. If a hash differs, the script identifies a "CHANGE". If a file is inaccessible or deleted, the hash function returns a null value, which is interpreted as a "DELETION".

When a change or deletion is detected, the Send-HIDSAlert function is immediately called. It uses the Send-MailMessage cmdlet with an SSL connection to send a secure notification. The alert details are sent to the destination email address defined in the configuration file. After the alert is sent, the baseline is automatically updated with the new state of the file, preventing repeated alerts for a change that has already been reported.
